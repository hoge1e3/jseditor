includes WaitMod;

\new(p) {
    Tonyu.extend(this,p);
}
\newFile() {
    var es=editorSet;
    var fl=fileList;
    var dir=fl.curDir;
    if (!dir) return;
    var n=waitFor(UIDiag.prompt("ファイル名"));
    var nf=dir.rel(n);
    var isd=waitFor(nf.isDir());
    if (isd) {
        dir=nf;
        waitFor(nf.mkdir());
    } else {
        waitFor(nf.text(""));
    }
    waitFor(fl.open(dir));
    if (!isd) {
        es.open(nf);
    }
}